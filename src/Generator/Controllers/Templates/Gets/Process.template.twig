$data = $request->getQueryParams();

try {
    $entities = $this->{{ refName }}Repository->matching((new CriteriaBuilder())($data));
    // before collection load to count all records without pagination
    $count = $entities->count();
    if ($count > 0) {
        $arrayEntities = (new ListExtractor())($this->hydrator, $entities->toArray());
        return (new GeneralSuccessResponseFactory())('Success', '{{ pluralRefName }}', $arrayEntities, 200, $count);
    } else {
        $msg = 'Could not find {{ pluralRefName }} using given conditions.';
        return (new GeneralErrorResponseFactory())($msg, '{{ pluralRefName }}', 404, [], 0);
    }
} catch (ORMException $exception) {
    $this->logger->error((string)$exception);
    $msg = 'There was an error while fetching {{ pluralRefName }}.';
    return (new GeneralErrorResponseFactory())($msg, '{{ pluralRefName }}', 400, [], 0);
}
